from time import sleep
from kafka import KafkaProducer
from json import dumps

producer = KafkaProducer(bootstrap_servers=['localhost:9092'],
                         value_serializer=lambda x:
                         dumps(x).encode('utf-8'))

topic = "predictions_alicante_alipark_flow"
message = {
    "timestamp": 1667861402180,
    "value": [
        11.482178688049316, 10.68167781829834, 9.927323341369629, 8.896958351135254, 7.259189605712891,
        5.87483549118042, 5.976729393005371, 6.335625171661377, 5.5250959396362305, 5.204633712768555,
        6.238473415374756, 6.785773754119873, 7.163661956787109, 8.32824993133545, 10.607486724853516,
        11.782916069030762, 13.376726150512695, 19.055015563964844, 22.445507049560547, 27.501710891723633,
        27.032712936401367, 32.26043701171875, 37.533870697021484, 33.560447692871094, 32.86008071899414,
        25.856420516967773, 25.49985694885254, 23.523149490356445, 22.946083068847656, 22.92793083190918,
        23.11955451965332, 21.012683868408203, 18.87403106689453, 16.78917121887207, 16.805131912231445,
        17.224454879760742, 17.75790023803711, 17.308923721313477, 18.536684036254883, 20.690113067626953,
        23.75927734375, 22.72098159790039, 19.051124572753906, 16.22152328491211, 15.217214584350586,
        14.701375961303711, 13.895902633666992, 13.363776206970215, 12.09773063659668, 10.314682006835938,
        9.318370819091797, 7.9817047119140625, 7.317298889160156, 6.434810638427734, 5.440229415893555,
        11.626882553100586, 15.69985580444336, 10.607969284057617, 6.444164752960205, 9.492403984069824,
        11.591374397277832, 13.100053787231445, 17.084617614746094, 21.966876983642578, 27.84000587463379,
        29.808225631713867, 28.45058822631836, 28.81763458251953, 28.318927764892578, 27.2520694732666,
        25.683643341064453, 24.77029800415039, 24.183422088623047, 23.657787322998047, 22.8575382232666, 21.184831619262695, 21.047271728515625, 21.61163330078125, 23.50731658935547, 21.819719314575195, 21.003108978271484, 20.459583282470703, 20.325204849243164, 19.35352897644043, 18.95321273803711, 19.072330474853516, 19.032794952392578, 19.2560977935791, 20.315399169921875, 20.783681869506836, 20.78121566772461, 19.28822135925293, 17.655654907226562, 16.81475067138672, 14.79642391204834, 13.66680908203125, 12.564205169677734, 11.03175163269043, 10.26229476928711, 9.771358489990234, 7.932155132293701, 6.610091209411621, 6.38962984085083, 6.463639736175537, 6.499887943267822, 6.461154460906982, 7.3819990158081055, 10.502978324890137, 11.960015296936035, 12.743229866027832, 16.086519241333008, 23.751930236816406, 25.582595825195312, 29.098392486572266, 26.278732299804688, 28.153989791870117, 26.46619415283203, 28.03385353088379, 26.413209915161133, 27.389001846313477, 25.43472671508789, 22.5518741607666, 22.706371307373047, 22.029565811157227, 22.524614334106445, 23.150634765625, 24.03068733215332, 21.96749496459961, 21.492996215820312, 20.6323184967041, 21.070812225341797, 23.58698081970215, 25.32955551147461, 23.528411865234375, 20.466876983642578, 21.532201766967773, 22.38640785217285, 21.40110969543457, 19.319400787353516, 18.756216049194336, 19.18309783935547, 19.311214447021484, 17.061372756958008, 16.38479232788086, 13.862669944763184, 12.212820053100586, 10.603591918945312, 8.472329139709473, 7.101633071899414, 6.291131496429443, 6.085764408111572, 12.053492546081543, 16.216529846191406, 12.921782493591309, 6.6102681159973145, 8.531874656677246, 12.748910903930664, 14.032649040222168, 17.300899505615234, 24.098154067993164, 26.071123123168945, 31.010398864746094, 28.99947166442871, 30.865625381469727, 29.66921043395996, 29.052989959716797, 26.924732208251953, 25.837011337280273, 26.47252655029297, 25.598468780517578, 24.134910583496094, 22.84021759033203, 22.07783317565918, 22.882080078125, 24.24411392211914, 23.049434661865234, 21.70305824279785, 21.373760223388672, 20.282306671142578, 19.75351333618164, 20.201698303222656, 19.103628158569336, 20.544200897216797, 21.515535354614258, 18.352466583251953, 18.818151473999023, 18.71074676513672, 18.13565444946289, 17.28070640563965, 15.67302131652832, 13.653329849243164, 12.852819442749023, 12.133091926574707, 11.202432632446289, 10.160083770751953, 9.993553161621094, 8.853378295898438, 8.061100006103516, 7.820022106170654, 7.256497383117676, 6.394099235534668, 6.068746089935303, 7.097593784332275, 9.216361999511719, 9.29399585723877, 8.938934326171875, 9.827180862426758, 12.935723304748535, 17.273963928222656, 23.9952449798584, 27.261075973510742, 28.836091995239258, 30.191551208496094, 31.236242294311523, 29.809295654296875, 27.417682647705078, 27.048147201538086, 24.597076416015625, 24.15492057800293, 24.01475715637207, 24.049161911010742, 24.732656478881836, 25.090253829956055, 22.250072479248047, 20.48998260498047, 18.994098663330078, 18.612037658691406, 18.686187744140625, 19.62269401550293, 18.99732208251953, 18.62940788269043, 17.632164001464844, 17.463314056396484, 17.82411766052246, 16.113750457763672, 14.954351425170898, 14.254364967346191, 14.350889205932617, 13.03568172454834, 12.06910228729248, 11.268721580505371, 10.54001522064209, 9.822281837463379, 8.964923858642578, 7.912827491760254, 6.6693620681762695, 5.586979866027832, 5.329929351806641, 5.509303092956543, 5.409049034118652, 5.674253463745117, 6.48051643371582, 7.049767017364502, 7.8582000732421875, 9.480878829956055, 12.011775016784668, 13.969620704650879, 20.08786964416504, 20.110363006591797, 26.477367401123047, 26.989013671875, 29.16149139404297, 27.79388427734375, 25.908004760742188, 24.675907135009766, 24.545421600341797, 24.11910629272461, 23.608699798583984, 23.490381240844727, 24.16695213317871, 23.596904754638672, 22.044904708862305, 19.396772384643555, 18.520244598388672, 18.099224090576172, 18.43543815612793, 18.757349014282227, 18.592025756835938, 18.18824577331543, 20.556041717529297, 21.011489868164062, 19.486778259277344, 17.943050384521484, 16.635761260986328, 15.18506145477295, 13.646699905395508, 12.655402183532715, 12.558191299438477, 11.877967834472656, 10.04280948638916, 8.440943717956543, 7.953531742095947, 7.352400779724121, 7.110873222351074, 6.617571830749512, 12.628378868103027, 15.099669456481934, 9.969426155090332, 6.804579734802246, 10.000936508178711, 12.381592750549316, 12.467817306518555, 17.84891128540039, 22.92740249633789, 24.32330322265625, 31.024005889892578, 27.39346694946289, 33.3038215637207, 28.983802795410156, 30.93330955505371, 26.925752639770508, 26.171157836914062, 25.72513198852539, 24.884828567504883, 25.52145767211914, 22.92985725402832, 22.18512535095215, 23.016206741333008, 22.61438751220703, 22.455825805664062, 20.67329978942871, 20.3170223236084, 19.536767959594727, 18.995864868164062, 19.182640075683594, 18.437698364257812, 19.966163635253906, 22.20738410949707, 22.329965591430664, 20.623762130737305, 18.326942443847656, 19.367639541625977, 19.16225814819336, 16.930702209472656, 15.408607482910156, 15.03956413269043
    ],
    "prediction_time": 1667895008.9638128
}

# make artificial values
message["value"] = []

for i in range(0, 384):
    message["value"].append(i)

# urn:ngsi-ld:Consumption:Spain-Alicante-
timestamp = 1668509450000  # early
timestamp = 1668550210000  # at 22:00
timestamp = 1668557410000  # at 01:00 next day
timestamp = 1668589810000  # at 10:00 next day
timestamp = 1668636610000  # at 22:00 next day

message["timestamp"] = timestamp

print(topic)

for i in range(1):
    print(i)
    #print(message)
    #for ind in range(len(message["value"])):
    #    message["value"][ind] += 0.3
    producer.send(topic, value=message)
    sleep(10)