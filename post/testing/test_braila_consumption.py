from time import sleep
from kafka import KafkaProducer
from json import dumps

producer = KafkaProducer(bootstrap_servers=['localhost:9092'],
                         value_serializer=lambda x:
                         dumps(x).encode('utf-8'))

topic = "predictions_braila_flow211206H360_prediction"
message = {
    "timestamp": 1665738040211,
    "value": [27.107162475585938, 26.819833755493164, 25.922199249267578, 25.777292251586914, 24.877206802368164, 24.012367248535156, 24.189605712890625, 25.07301902770996, 25.554969787597656, 25.590177536010742, 26.88665199279785, 26.038591384887695, 25.037473678588867, 24.436647415161133, 23.421194076538086, 22.310741424560547, 20.885406494140625, 19.38142204284668, 18.131624221801758, 17.2280216217041, 16.516693115234375, 15.930681228637695, 15.42026138305664, 15.126266479492188, 15.123682022094727, 14.975765228271484, 15.116887092590332, 15.353273391723633, 15.331069946289062, 15.383787155151367, 15.474483489990234, 15.658895492553711, 15.765518188476562, 15.942743301391602, 16.016592025756836, 16.20009994506836, 17.32929801940918, 21.39251708984375, 24.77376365661621, 26.853376388549805, 28.28989601135254, 29.99585723876953, 31.134435653686523, 29.071500778198242, 30.164012908935547, 30.819669723510742, 31.32223129272461, 31.575969696044922, 31.786470413208008, 32.06135177612305, 31.815067291259766, 31.61159324645996, 31.43784523010254, 31.134868621826172, 31.289213180541992, 30.715473175048828, 30.285417556762695, 30.327604293823242, 30.08649444580078, 30.24801254272461, 30.00235366821289, 29.489418029785156, 29.743328094482422, 29.340055465698242, 28.996261596679688, 29.02521324157715, 28.87885856628418, 28.748886108398438, 28.838199615478516, 28.798643112182617, 28.648244857788086, 27.91641616821289, 26.288530349731445, 24.943777084350586, 24.763986587524414, 24.310344696044922, 24.420169830322266, 24.737913131713867, 25.20195198059082, 25.935302734375, 26.456279754638672, 27.198957443237305, 27.249601364135742, 27.050464630126953, 26.694381713867188, 26.466632843017578, 25.353004455566406, 24.730403900146484, 23.869897842407227, 22.900827407836914, 22.355194091796875, 21.72785186767578, 20.58878517150879, 19.2519588470459, 18.004911422729492, 16.692373275756836, 15.883886337280273, 15.911930084228516, 16.169538497924805, 16.16373634338379, 16.050500869750977, 16.83677101135254, 16.77455711364746, 16.64208984375, 16.553424835205078, 16.15823745727539, 15.76291275024414, 15.350643157958984, 15.13751220703125, 15.117080688476562, 15.201810836791992, 15.54365348815918, 16.622774124145508, 17.888532638549805, 18.86031723022461, 19.409379959106445, 19.924816131591797, 20.74924087524414, 22.598041534423828, 22.294231414794922, 23.95075035095215, 25.77425765991211, 27.22015380859375, 28.967205047607422, 30.195207595825195, 30.474327087402344, 30.459306716918945, 30.154298782348633, 29.921634674072266, 29.522274017333984, 29.514850616455078, 29.343652725219727, 29.375896453857422, 29.37522315979004, 29.178558349609375, 29.13228988647461, 29.092391967773438, 29.1478328704834, 29.5648136138916, 28.941850662231445, 28.468788146972656, 27.79741668701172, 27.580608367919922, 27.3194522857666, 27.28060531616211, 27.24936294555664, 27.118408203125, 27.161314010620117, 27.39476203918457, 27.87285041809082, 27.963624954223633, 27.860008239746094, 27.235759735107422, 27.284847259521484, 27.21201515197754, 27.282428741455078, 27.14875030517578, 15.192480087280273, 15.176849365234375, 15.145122528076172, 15.224119186401367, 15.414005279541016, 15.530614852905273, 15.56502914428711, 16.007183074951172, 16.716022491455078, 17.524560928344727, 17.965112686157227, 18.399452209472656, 18.950971603393555, 19.638275146484375, 20.8262939453125, 21.821611404418945, 22.269550323486328, 23.116064071655273, 23.8726749420166, 25.017108917236328, 26.008230209350586, 26.515827178955078, 27.102338790893555, 26.634113311767578, 26.092069625854492, 25.743438720703125, 25.33968162536621, 25.365863800048828, 25.20340919494629, 25.584428787231445, 25.738113403320312, 25.948034286499023, 25.743091583251953, 25.534475326538086, 25.025245666503906, 24.63580322265625, 24.402481079101562, 24.04241371154785, 23.91639518737793, 23.522804260253906, 23.402725219726562, 22.672563552856445, 22.356048583984375, 22.515018463134766, 23.081560134887695, 23.432172775268555, 23.53542137145996, 24.024965286254883, 24.568052291870117, 25.460739135742188, 26.205156326293945, 27.117420196533203, 27.22637367248535, 27.108524322509766, 26.871849060058594, 26.447080612182617, 26.24169921875, 25.696271896362305, 25.068326950073242, 23.732555389404297, 22.557992935180664, 20.96774673461914, 19.278749465942383, 17.76569366455078, 16.45510482788086, 15.365633010864258, 14.629598617553711, 14.411096572875977, 14.751821517944336, 14.87838363647461, 14.937284469604492, 15.00162124633789, 15.165876388549805, 15.250158309936523, 15.274473190307617, 15.19593620300293, 15.093050003051758, 15.150392532348633, 15.15711784362793, 15.272510528564453, 15.842313766479492, 17.40326690673828, 18.7071475982666, 19.908464431762695, 20.945083618164062, 22.310617446899414, 23.98765754699707, 27.36119842529297, 27.076650619506836, 27.322589874267578, 27.887752532958984, 27.94455909729004, 27.05681800842285, 26.79721450805664, 27.32343292236328, 27.460975646972656, 27.327421188354492, 27.232507705688477, 27.14118003845215, 26.818050384521484, 25.772729873657227, 24.90253257751465, 24.8288631439209, 24.723909378051758, 25.397159576416016, 25.742372512817383, 25.305564880371094, 25.569459915161133, 25.40047836303711, 24.867048263549805, 24.016935348510742, 23.91250228881836, 24.442155838012695, 24.694528579711914, 25.288387298583984, 25.84671974182129, 25.903966903686523, 26.07427406311035, 25.90906524658203, 25.752187728881836, 25.399295806884766, 25.529071807861328, 25.56275177001953, 15.194019317626953, 15.352371215820312, 15.526247024536133, 15.676950454711914, 15.775543212890625, 15.713006973266602, 15.898347854614258, 16.15507698059082, 16.63004493713379, 17.92498779296875, 18.906585693359375, 20.01030731201172, 21.205944061279297, 22.720115661621094, 24.346895217895508, 26.420413970947266, 26.3317813873291, 26.305505752563477, 26.23603630065918, 26.12445068359375, 25.964963912963867, 26.10685920715332, 26.287431716918945, 26.635852813720703, 26.67603874206543, 26.13494873046875, 25.751935958862305, 25.51059341430664, 24.57964324951172, 24.009483337402344, 23.917678833007812, 24.181032180786133, 24.509883880615234, 24.42474365234375, 24.541805267333984, 24.419355392456055, 24.082744598388672, 23.742359161376953, 23.05858039855957, 22.952123641967773, 22.995285034179688, 23.18642234802246, 24.027999877929688, 24.55570411682129, 25.571537017822266, 26.134361267089844, 26.20424461364746, 26.7315673828125, 26.77048683166504, 26.88572120666504, 27.234636306762695, 16.136371612548828, 16.378040313720703, 16.3862247467041, 16.511245727539062, 16.18916130065918, 15.875740051269531, 15.945499420166016, 16.136777877807617, 17.06203269958496, 18.472970962524414, 19.39923667907715, 20.140403747558594, 21.233739852905273, 22.5920352935791, 24.154605865478516, 25.681995391845703, 25.703813552856445, 25.752552032470703, 25.74378776550293, 26.21065330505371, 26.809314727783203, 27.028419494628906, 27.347261428833008, 27.341691970825195, 27.535764694213867, 28.027324676513672, 28.255836486816406, 28.24043846130371, 26.98569679260254, 26.129945755004883, 24.986759185791016, 24.39884376525879, 24.560222625732422, 24.61703872680664, 24.515043258666992, 24.201017379760742, 24.199848175048828, 24.084192276000977, 24.302183151245117, 24.32842254638672, 24.340726852416992, 24.612442016601562, 25.62637710571289, 26.474119186401367, 26.716411590576172, 26.75102996826172, 26.62639045715332, 26.31879234313965, 26.568578720092773, 27.0416202545166, 27.256946563720703, 27.588327407836914, 27.802501678466797, 27.80291748046875, 27.79822540283203, 27.140295028686523, 26.090261459350586, 25.308795928955078, 24.433053970336914, 23.415359497070312, 22.475656509399414, 21.346406936645508, 19.62940788269043, 17.70424461364746, 16.486799240112305, 15.585233688354492, 15.128715515136719, 14.792518615722656, 14.649404525756836, 15.159683227539062, 15.239299774169922, 15.122171401977539, 15.02891731262207, 14.981057167053223, 15.070683479309082, 15.056758880615234, 14.972476959228516, 14.987028121948242, 15.246612548828125, 15.625141143798828, 16.89642906188965, 18.686973571777344, 19.76181411743164, 20.628841400146484, 21.63425064086914, 23.254100799560547, 24.77348518371582, 27.031391143798828, 26.959444046020508, 26.72593116760254, 26.473642349243164, 26.463560104370117, 26.784914016723633, 27.8248348236084, 28.57229232788086, 28.64974021911621, 28.64901351928711, 28.394939422607422, 27.689146041870117, 26.785947799682617, 25.912200927734375, 25.682720184326172, 25.776403427124023, 25.766983032226562, 25.519500732421875, 24.528003692626953, 24.602632522583008, 24.278629302978516, 24.5647029876709, 24.417882919311523, 24.268665313720703, 24.47787857055664, 24.752376556396484, 24.914552688598633, 24.981464385986328, 25.15360450744629, 25.416284561157227, 26.591724395751953, 26.697872161865234, 26.879039764404297, 27.067052841186523, 27.459938049316406, 27.61302947998047, 28.50990867614746, 29.017284393310547, 28.450531005859375, 27.993877410888672, 27.257925033569336, 26.548664093017578, 25.590057373046875, 24.75791358947754, 24.26903533935547, 23.079753875732422, 21.56789779663086, 19.680654525756836, 18.284576416015625, 16.935394287109375, 15.836851119995117, 15.323795318603516, 15.039873123168945, 14.985477447509766, 14.6775541305542, 14.877670288085938, 15.045832633972168, 15.276481628417969, 15.556791305541992, 15.740631103515625, 15.684030532836914, 15.534772872924805, 15.523876190185547, 15.760747909545898, 16.111528396606445, 17.388818740844727, 18.94443130493164, 19.783695220947266, 20.40302276611328, 21.739656448364258, 23.13267707824707, 24.722015380859375, 25.753732681274414, 25.547012329101562, 24.714427947998047, 24.80893898010254, 24.87725257873535, 24.947853088378906, 24.596647262573242, 24.159196853637695, 23.856727600097656, 23.590606689453125, 23.180660247802734, 23.1474666595459, 22.81008529663086, 23.075387954711914],
    "prediction_time": 1665755424.22619
}

print(len(message["value"]))

for i in range(1):
    print(i)
    producer.send(topic, value=message)
    sleep(1)